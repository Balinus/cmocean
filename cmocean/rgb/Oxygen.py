
from matplotlib.colors import LinearSegmentedColormap
from numpy import nan, inf

# Used to reconstruct the colormap in pycam02ucs.cm.viscm
parameters = {'xp': [26.22849758266426, 4.479872111264228, 0.06490018935861741, 0.3933776367819348, -0.6758517944596747, -4.7514708865895443],
              'yp': [16.27492877492881, 2.483164983165011, 0.5340738914457148, 0.36983516773405256, 2.483164983165011, 25.244877257050149],
              'min_JK': 15.1269035533,
              'max_JK': 97.1573604061}

cm_data = [[ 0.2561064 ,  0.00508228,  0.0022039 ],
       [ 0.25964265,  0.00855582,  0.0034945 ],
       [ 0.26313629,  0.01221502,  0.00491913],
       [ 0.26658285,  0.01607252,  0.00648669],
       [ 0.269985  ,  0.0201276 ,  0.008201  ],
       [ 0.27334635,  0.02437744,  0.01006466],
       [ 0.27666133,  0.02883712,  0.01208838],
       [ 0.27993961,  0.03349149,  0.01426885],
       [ 0.28317335,  0.03836027,  0.01661934],
       [ 0.28637049,  0.04332051,  0.01913742],
       [ 0.28952854,  0.04813667,  0.02183117],
       [ 0.2926481 ,  0.05283419,  0.02470553],
       [ 0.29573381,  0.05742379,  0.02776037],
       [ 0.29877916,  0.06193177,  0.03100927],
       [ 0.30179456,  0.06635361,  0.03444416],
       [ 0.30476989,  0.07071585,  0.03808403],
       [ 0.30771588,  0.07501092,  0.04187959],
       [ 0.31062614,  0.07925597,  0.04567049],
       [ 0.3135056 ,  0.08345047,  0.04945166],
       [ 0.31635339,  0.08760147,  0.05322715],
       [ 0.31916907,  0.09171448,  0.05699997],
       [ 0.32195683,  0.09578861,  0.06076667],
       [ 0.32471131,  0.09983443,  0.06453622],
       [ 0.32744131,  0.1038448 ,  0.06829891],
       [ 0.33013708,  0.1078344 ,  0.07206878],
       [ 0.33281129,  0.11179148,  0.07583119],
       [ 0.33545092,  0.11573324,  0.07960367],
       [ 0.33807011,  0.11964647,  0.08336989],
       [ 0.34065712,  0.12354596,  0.08714528],
       [ 0.34322355,  0.12742147,  0.09091678],
       [ 0.34575979,  0.13128469,  0.09469677],
       [ 0.34827563,  0.13512746,  0.09847453],
       [ 0.35076288,  0.13895937,  0.1022604 ],
       [ 0.35323022,  0.1427735 ,  0.10604508],
       [ 0.35567017,  0.14657825,  0.1098378 ],
       [ 0.35809105,  0.15036714,  0.11362976],
       [ 0.3604853 ,  0.15414824,  0.11743004],
       [ 0.36286171,  0.15791475,  0.12122944],
       [ 0.36521179,  0.16167519,  0.12503784],
       [ 0.36754567,  0.16542173,  0.12884468],
       [ 0.36985306,  0.16916407,  0.13266158],
       [ 0.37214632,  0.1728927 ,  0.13647574],
       [ 0.37441242,  0.17661918,  0.14030143],
       [ 0.37666568,  0.18033263,  0.14412397],
       [ 0.37889312,  0.1840442 ,  0.14795734],
       [ 0.38110702,  0.18774486,  0.15178914],
       [ 0.38329831,  0.19144236,  0.15562912],
       [ 0.38547414,  0.19513182,  0.15947027],
       [ 0.3876311 ,  0.19881647,  0.16331645],
       [ 0.38977013,  0.20249614,  0.16716698],
       [ 0.39189454,  0.20616899,  0.17101892],
       [ 0.393998  ,  0.20984011,  0.1748788 ],
       [ 0.39609089,  0.21350263,  0.17873675],
       [ 0.39816074,  0.2171658 ,  0.18260518],
       [ 0.40021971,  0.22082161,  0.18647261],
       [ 0.40226132,  0.22447499,  0.19034552],
       [ 0.40428753,  0.22812503,  0.19422229],
       [ 0.40630267,  0.23176929,  0.19809913],
       [ 0.40829731,  0.2354144 ,  0.20198511],
       [ 0.41028278,  0.23905332,  0.20586987],
       [ 0.41225195,  0.24269107,  0.20976029],
       [ 0.41420738,  0.24632636,  0.21365421],
       [ 0.41615416,  0.24995637,  0.21754726],
       [ 0.41808095,  0.25358851,  0.22144989],
       [ 0.4199992 ,  0.257216  ,  0.22535199],
       [ 0.42190642,  0.26084077,  0.22925605],
       [ 0.42379732,  0.26446629,  0.23316693],
       [ 0.4256804 ,  0.2680878 ,  0.23707734],
       [ 0.4275515 ,  0.27170807,  0.24099113],
       [ 0.42940876,  0.27532847,  0.24491009],
       [ 0.43125862,  0.27894555,  0.24882885],
       [ 0.4330974 ,  0.28256175,  0.25275079],
       [ 0.43492302,  0.28617849,  0.25667781],
       [ 0.43674169,  0.28979254,  0.26060485],
       [ 0.43855202,  0.29340497,  0.26453327],
       [ 0.44034806,  0.2970193 ,  0.26846819],
       [ 0.44213759,  0.30063152,  0.27240331],
       [ 0.44392067,  0.30424188,  0.27633878],
       [ 0.44569212,  0.30785339,  0.280279  ],
       [ 0.44745465,  0.31146482,  0.28422188],
       [ 0.4492112 ,  0.31507487,  0.28816522],
       [ 0.45096183,  0.31868378,  0.29210915],
       [ 0.45270159,  0.32229431,  0.29605776],
       [ 0.45443394,  0.32590489,  0.30000843],
       [ 0.45616088,  0.32951474,  0.30395972],
       [ 0.45788248,  0.33312405,  0.30791173],
       [ 0.45959827,  0.33673327,  0.31186499],
       [ 0.4613041 ,  0.34034468,  0.31582282],
       [ 0.46300517,  0.34395588,  0.3197813 ],
       [ 0.46470161,  0.34756704,  0.3237405 ],
       [ 0.4663935 ,  0.35117834,  0.32770047],
       [ 0.46808097,  0.35478991,  0.33166125],
       [ 0.46976413,  0.35840192,  0.33562287],
       [ 0.47144048,  0.36201572,  0.33958728],
       [ 0.47311256,  0.36563032,  0.34355267],
       [ 0.47478114,  0.36924554,  0.34751859],
       [ 0.47644641,  0.3728615 ,  0.35148499],
       [ 0.47810853,  0.37647831,  0.35545182],
       [ 0.47976772,  0.38009607,  0.35941902],
       [ 0.48142419,  0.38371487,  0.3633865 ],
       [ 0.48307817,  0.38733479,  0.36735414],
       [ 0.48472992,  0.39095592,  0.37132182],
       [ 0.48637971,  0.3945783 ,  0.37528937],
       [ 0.48802786,  0.39820199,  0.3792566 ],
       [ 0.4896747 ,  0.40182705,  0.3832233 ],
       [ 0.49132057,  0.40545349,  0.38718922],
       [ 0.49296586,  0.40908134,  0.39115408],
       [ 0.49461101,  0.4127106 ,  0.39511756],
       [ 0.49625646,  0.41634128,  0.3990793 ],
       [ 0.49789983,  0.41997457,  0.4030408 ],
       [ 0.49954331,  0.42360972,  0.40700047],
       [ 0.50118829,  0.42724635,  0.41095728],
       [ 0.50283539,  0.43088441,  0.41491068],
       [ 0.50448498,  0.43452396,  0.41886023],
       [ 0.50613216,  0.43816718,  0.42280876],
       [ 0.5077833 ,  0.44181168,  0.42675195],
       [ 0.5094393 ,  0.44545733,  0.43068891],
       [ 0.51109315,  0.44910716,  0.43462351],
       [ 0.5127534 ,  0.45275798,  0.43855001],
       [ 0.51441536,  0.45641187,  0.44247064],
       [ 0.51608237,  0.46006778,  0.44638268],
       [ 0.51775202,  0.4637269 ,  0.45028668],
       [ 0.51942927,  0.46738758,  0.45417882],
       [ 0.52110736,  0.47105274,  0.45806164],
       [ 0.52279269,  0.47472021,  0.46193011],
       [ 0.52448489,  0.4783905 ,  0.46578274],
       [ 0.52618373,  0.48206406,  0.46961755],
       [ 0.5278893 ,  0.48574132,  0.47343193],
       [ 0.52960208,  0.48942258,  0.47722246],
       [ 0.531323  ,  0.49310804,  0.4809848 ],
       [ 0.53305357,  0.4967978 ,  0.48471345],
       [ 0.53479597,  0.5004918 ,  0.48840154],
       [ 0.53655101,  0.50419066,  0.4920413 ],
       [ 0.53831984,  0.50789509,  0.49562291],
       [ 0.54010578,  0.5116052 ,  0.49913341],
       [ 0.54191348,  0.51532084,  0.50255687],
       [ 0.54374856,  0.51904183,  0.50587426],
       [ 0.54562053,  0.52276666,  0.50906345],
       [ 0.54754161,  0.52649292,  0.512101  ],
       [ 0.54953255,  0.53021444,  0.51496622],
       [ 0.55161587,  0.53392364,  0.51764621],
       [ 0.55381559,  0.53761107,  0.52014135],
       [ 0.55614736,  0.5412695 ,  0.52246471],
       [ 0.55861535,  0.5448955 ,  0.5246384 ],
       [ 0.56121195,  0.5484902 ,  0.526686  ],
       [ 0.56392418,  0.55205686,  0.52863124],
       [ 0.56673568,  0.55560063,  0.53049147],
       [ 0.56963172,  0.5591262 ,  0.53228159],
       [ 0.57259983,  0.56263741,  0.53401517],
       [ 0.57562848,  0.56613862,  0.53569661],
       [ 0.57870995,  0.56963183,  0.53733842],
       [ 0.58183662,  0.5731201 ,  0.53894146],
       [ 0.58500309,  0.57660519,  0.5405109 ],
       [ 0.58820488,  0.58008861,  0.54205064],
       [ 0.59143834,  0.58357164,  0.54356343],
       [ 0.59470044,  0.58705539,  0.54505112],
       [ 0.59798873,  0.59054082,  0.54651476],
       [ 0.60130118,  0.59402877,  0.54795474],
       [ 0.60463612,  0.59751934,  0.54937796],
       [ 0.60799208,  0.60101364,  0.55077945],
       [ 0.61136791,  0.60451207,  0.55216095],
       [ 0.61476251,  0.60801471,  0.55352676],
       [ 0.61817513,  0.61152236,  0.55487253],
       [ 0.62160491,  0.61503498,  0.55620296],
       [ 0.62505126,  0.61855299,  0.55751707],
       [ 0.62851378,  0.62207694,  0.55881138],
       [ 0.63199164,  0.62560635,  0.56009542],
       [ 0.63548472,  0.62914199,  0.56136222],
       [ 0.63899268,  0.63268406,  0.56261176],
       [ 0.64251519,  0.63623265,  0.5638456 ],
       [ 0.64605168,  0.63978753,  0.56506926],
       [ 0.64960223,  0.64334928,  0.5662772 ],
       [ 0.65316661,  0.64691799,  0.56746993],
       [ 0.65674466,  0.65049378,  0.5686479 ],
       [ 0.6603362 ,  0.65407676,  0.5698115 ],
       [ 0.66394111,  0.65766703,  0.57096104],
       [ 0.66755926,  0.66126469,  0.57209679],
       [ 0.67119057,  0.66486984,  0.57321895],
       [ 0.67483494,  0.66848257,  0.57432769],
       [ 0.67849231,  0.67210299,  0.57542311],
       [ 0.68216264,  0.67573119,  0.57650525],
       [ 0.68584589,  0.67936726,  0.57757415],
       [ 0.68954204,  0.68301129,  0.57862976],
       [ 0.69325106,  0.68666338,  0.57967201],
       [ 0.69697298,  0.69032362,  0.58070079],
       [ 0.70070779,  0.6939921 ,  0.58171594],
       [ 0.70445552,  0.69766891,  0.58271728],
       [ 0.70821619,  0.70135415,  0.58370459],
       [ 0.71198985,  0.70504789,  0.5846776 ],
       [ 0.71577654,  0.70875022,  0.58563602],
       [ 0.71957575,  0.71246089,  0.58658653],
       [ 0.72338794,  0.71618024,  0.58752357],
       [ 0.72721327,  0.71990843,  0.58844581],
       [ 0.73105181,  0.72364554,  0.58935282],
       [ 0.73490365,  0.72739165,  0.59024417],
       [ 0.73876833,  0.73114656,  0.59112571],
       [ 0.74264594,  0.73491037,  0.59199676],
       [ 0.74653703,  0.73868342,  0.59285154],
       [ 0.75044171,  0.7424658 ,  0.59368954],
       [ 0.75435969,  0.7462574 ,  0.59451473],
       [ 0.7582905 ,  0.75005801,  0.59533279],
       [ 0.76223515,  0.7538682 ,  0.5961332 ],
       [ 0.76619376,  0.75768805,  0.59691532],
       [ 0.77016543,  0.76151715,  0.59768972],
       [ 0.77415064,  0.76535578,  0.59845173],
       [ 0.77815011,  0.76920432,  0.59919435],
       [ 0.78216341,  0.77306258,  0.59992305],
       [ 0.78618988,  0.77693032,  0.60064542],
       [ 0.79023093,  0.7808082 ,  0.60134712],
       [ 0.79428625,  0.78469611,  0.6020325 ],
       [ 0.79835475,  0.78859362,  0.60271357],
       [ 0.8024382 ,  0.79250152,  0.60337252],
       [ 0.80653598,  0.79641958,  0.60401679],
       [ 0.81064737,  0.80034755,  0.60465447],
       [ 0.8147741 ,  0.80428615,  0.60526845],
       [ 0.81891481,  0.80823488,  0.60587367],
       [ 0.82307002,  0.81219398,  0.60646549],
       [ 0.827241  ,  0.81616397,  0.60703185],
       [ 0.83142515,  0.82014393,  0.60759992],
       [ 0.83562519,  0.82413488,  0.60814301],
       [ 0.83984013,  0.8281365 ,  0.60867193],
       [ 0.84406958,  0.8321487 ,  0.60919142],
       [ 0.84831554,  0.8361722 ,  0.60968253],
       [ 0.85257486,  0.84020599,  0.61017706],
       [ 0.85685088,  0.8442512 ,  0.61064309],
       [ 0.86114172,  0.84830728,  0.61109986],
       [ 0.8654482 ,  0.85237452,  0.61154025],
       [ 0.86977089,  0.85645314,  0.61195964],
       [ 0.87410824,  0.86054272,  0.61237376],
       [ 0.8784631 ,  0.86464414,  0.61275612],
       [ 0.88283174,  0.86875637,  0.61314326],
       [ 0.88721834,  0.87288064,  0.6134962 ],
       [ 0.89161948,  0.87701606,  0.6138483 ],
       [ 0.89603815,  0.88116347,  0.61417214],
       [ 0.90047226,  0.88532238,  0.61448833],
       [ 0.90492347,  0.88949326,  0.61478214],
       [ 0.9093909 ,  0.89367594,  0.61506271],
       [ 0.91387513,  0.89787062,  0.61532548],
       [ 0.91837623,  0.90207736,  0.61557069],
       [ 0.92289398,  0.90629617,  0.61580133],
       [ 0.92742912,  0.91052727,  0.61601142],
       [ 0.9319809 ,  0.91477054,  0.61620876],
       [ 0.93655044,  0.9190263 ,  0.61638393],
       [ 0.94113679,  0.92329439,  0.61654671],
       [ 0.94574112,  0.92757511,  0.61668718],
       [ 0.95036257,  0.93186835,  0.61681406],
       [ 0.95500206,  0.93617436,  0.61691997],
       [ 0.95965919,  0.94049311,  0.61700953],
       [ 0.96433423,  0.94482472,  0.61708104],
       [ 0.96902761,  0.94916933,  0.61713175],
       [ 0.97373861,  0.95352686,  0.61716897],
       [ 0.97846884,  0.95789769,  0.61717923],
       [ 0.98321619,  0.9622815 ,  0.61718225],
       [ 0.98798388,  0.96667891,  0.61715037],
       [ 0.99276799,  0.97108932,  0.61711925],
       [ 0.99757378,  0.97551368,  0.61704342]]

test_cm = LinearSegmentedColormap.from_list(__file__, cm_data)


if __name__ == "__main__":
    import matplotlib.pyplot as plt
    import numpy as np

    try:
        from pycam02ucs.cm.viscm import viscm
        viscm(test_cm)
    except ImportError:
        print("pycam02ucs not found, falling back on simple display")
        plt.imshow(np.linspace(0, 100, 256)[None, :], aspect='auto',
                   cmap=test_cm)
    plt.show()
